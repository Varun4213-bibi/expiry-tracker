{% extends 'base.html' %}
{% load static %}

{% block title %}Profile - Expiry Tracker{% endblock %}

{% block content %}
<div class="container-fluid py-5" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); min-height: 100vh;">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <div class="card shadow-lg border-0 rounded-4 overflow-hidden">

        <!-- Profile Header -->
        <div class="card-header text-white text-center py-4"
             style="background: linear-gradient(45deg, #00050e, #043072);">
          <div class="mb-3">
            <div class="mx-auto"
                 style="width:100px;height:100px;border-radius:50%;
                 background:linear-gradient(45deg,#ff6b6b,#4ecdc4);
                 display:flex;align-items:center;justify-content:center;
                 font-size:2.5rem;font-weight:bold;">
              {{ user.first_name|first|default:user.username|first|upper }}
            </div>
          </div>
          <h2 class="mb-1">{{ user.first_name|default:user.username }} {{ user.last_name }}</h2>
          <p class="mb-0 opacity-75">{{ user.email }}</p>
        </div>

        <!-- Profile Body -->
        <div class="card-body p-4">
          <h4 class="text-center mb-4">Edit Profile Information</h4>

          <form method="post">
            {% csrf_token %}

            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <input type="text" class="form-control"
                       name="{{ form.first_name.name }}"
                       value="{{ form.first_name.value|default_if_none:'' }}"
                       placeholder="First Name">
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control"
                       name="{{ form.last_name.name }}"
                       value="{{ form.last_name.value|default_if_none:'' }}"
                       placeholder="Last Name">
              </div>
            </div>

            <div class="mb-3">
              <input type="email" class="form-control"
                     name="{{ form.email.name }}"
                     value="{{ form.email.value|default_if_none:'' }}"
                     placeholder="Email">
            </div>

            <div class="card bg-light mb-3">
              <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                  <strong>Email Reminders</strong><br>
                  <small class="text-muted">Receive expiry emails</small>
                </div>
                <input class="form-check-input" type="checkbox"
                       name="{{ form.email_reminders_enabled.name }}"
                       {% if form.email_reminders_enabled.value %}checked{% endif %}>
              </div>
            </div>

            <div class="card bg-light mb-3">
              <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                  <strong>Push Notifications</strong><br>
                  <small class="text-muted">Chrome notifications</small>
                  <div id="push-notification-status"
                       class="small text-muted mt-1"></div>
                </div>

                <input class="form-check-input"
                       type="checkbox"
                       id="id_push_reminders_enabled"
                       name="{{ form.push_reminders_enabled.name }}"
                       {% if form.push_reminders_enabled.value %}checked{% endif %}>
              </div>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg">
                Save Changes
              </button>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/push-notifications.js' %}"></script>
{% endblock %}
